class Reserva{constructor(nome,equipamento,status){this.nome=nome;this.equipamento=equipamento;this.status=status}
validarDados(){for(let r in this){if(this[r]===""||this[r]===null||this[r]===undefined){return!1}}
return!0}}
class ReservaProfessor extends Reserva{constructor(nome,equipamento,status,sala,dataA,horaA,dataB,horaB,horaC,horaD){super(nome,equipamento,status);this.sala=sala;this.dataA=dataA;this.dataB=dataB;this.horaA=horaA;this.horaB=horaB;this.horaC=horaC;this.horaD=horaD}}
class ReservaAluno extends Reserva{constructor(nome,equipamento,status,matricula,serial,dataA,horaA,dataB,horaB,horaC){super(nome,equipamento,status);this.matricula=matricula;this.serial=serial;this.dataA=dataA;this.dataB=dataB;this.horaA=horaA;this.horaB=horaB;this.horaC=horaC}}
class Funcionario{constructor(nome,dataA,horaA,versao){this.nome=nome;this.dataA=dataA;this.horaA=horaA;this.versao=versao}
validarFuncionario(){for(let f in this){if(this[f]===""||this[f]===null||this[f]===undefined){return!1}}
return!0}}
class BancodeDados{constructor(){let idAluno=localStorage.getItem('idAluno');let idProfessor=localStorage.getItem('idProfessor');let versao=localStorage.getItem("versao");if(idAluno===null){localStorage.setItem('idAluno',0)}
if(idProfessor===null){localStorage.setItem('idProfessor',0)}
if(versao===null||versao==="1.6.0-beta"){localStorage.setItem("versao","1.6.1-beta")}}
getProximoId(nome){let idAluno=parseInt(localStorage.getItem('idAluno'));let idProfessor=parseInt(localStorage.getItem('idProfessor'));let proximoId=null;if(nome=="Professor"){if(idAluno>idProfessor){for(let i=0;i<=idAluno;i++){proximoId=i+1}
return proximoId}else if(idProfessor>idAluno){proximoId=(idProfessor+1);return proximoId}else if(idProfessor==idAluno){proximoId=(idProfessor+1);return proximoId}
else{return 0}}
else if(nome=="Aluno"){if(idProfessor>idAluno){for(let i=0;i<=idProfessor;i++){proximoId=i+1}
return proximoId}else if(idAluno>idProfessor){proximoId=(idAluno+1);return proximoId}else if(idAluno==idProfessor){proximoId=(idAluno+1);return proximoId}else{return 0}}}
gravar(reserva,nome){let id=this.getProximoId(nome);localStorage.setItem(id,JSON.stringify(reserva));localStorage.setItem(`id${nome}`,id)}
gravarFuncionario(funcionario){let id=0;localStorage.setItem(id,JSON.stringify(funcionario));localStorage.setItem("idFuncionario",id)}
recuperaReservaProfessor(){let reservas=Array();let id=localStorage.getItem("idProfessor");for(let i=0;i<=id;i++){let reserva=JSON.parse(localStorage.getItem(i));if(reserva===null||reserva.nome===undefined||reserva.equipamento===undefined||reserva.status===undefined||reserva.sala===undefined||reserva.dataA===undefined||reserva.dataB===undefined||reserva.horaA===undefined||reserva.horaB===undefined){continue}
reserva.id=i;reservas.push(reserva)}
return reservas}
recuperaReservaAluno(){let reservas=Array();let id=localStorage.getItem("idAluno");for(let i=0;i<=id;i++){let reserva=JSON.parse(localStorage.getItem(i));if(reserva===null||reserva.nome===undefined||reserva.equipamento===undefined||reserva.matricula===undefined||reserva.serial===undefined){continue}
reserva.id=i;reservas.push(reserva)}
return reservas}
recuperarDadosFuncionario(){let funcionarios=Array();let id=localStorage.getItem("idFuncionario");for(let i=0;i<=id;i++){let funcionario=JSON.parse(localStorage.getItem(i));if(funcionario===null){continue}
funcionario.id=i;funcionarios.push(funcionario)}
return funcionarios}
pesquisaReserva(reserva,nome){if(nome=="Professor"){let reservasFiltradas=Array();reservasFiltradas=this.recuperaReservaProfessor();if(reserva.nome!=""){reservasFiltradas=reservasFiltradas.filter(p=>p.nome==reserva.nome)}
if(reserva.equipamento!=""){reservasFiltradas=reservasFiltradas.filter(p=>p.equipamento==reserva.equipamento)}
if(reserva.sala!=""){reservasFiltradas=reservasFiltradas.filter(p=>p.sala==reserva.sala)}
if(reserva.dataA!=""){reservasFiltradas=reservasFiltradas.filter(p=>p.dataA==reserva.dataA)}
if(reserva.horaA!=""){reservasFiltradas=reservasFiltradas.filter(p=>p.horaA==reserva.horaA)}
if(reserva.horaB!=""){reservasFiltradas=reservasFiltradas.filter(p=>p.horaB==reserva.horaB)}
return reservasFiltradas}
else if(nome=="Aluno"){let reservasFiltradas=Array();reservasFiltradas=this.recuperaReservaAluno();if(reserva.nome!=""){reservasFiltradas=reservasFiltradas.filter(a=>a.nome==reserva.nome)}
if(reserva.matricula!=""){reservasFiltradas=reservasFiltradas.filter(a=>a.matricula==reserva.matricula)}
if(reserva.equipamento!=""){reservasFiltradas=reservasFiltradas.filter(a=>a.equipamento==reserva.equipamento)}
if(reserva.serial!=""){reservasFiltradas=reservasFiltradas.filter(a=>a.serial==reserva.serial)}
if(reserva.dataA!=""){reservasFiltradas=reservasFiltradas.filter(p=>p.dataA==reserva.dataA)}
if(reserva.horaA!=""){reservasFiltradas=reservasFiltradas.filter(p=>p.horaA==reserva.horaA)}
return reservasFiltradas}}
retornaVersao(){let versao=localStorage.getItem("versao");return versao}
removerReserva(id){localStorage.removeItem(id)}}
let bancodedados=new BancodeDados();function cadastrarReservaProfessor(){let nome=document.getElementById('professor');let equipamento=document.getElementById('equipamento');let status="Aguardando";let sala=document.getElementById('sala');let dataA=document.getElementById('dataA');let horaA=document.getElementById('horaA');let dataB="0000-00-00"
let horaB=document.getElementById('horaB');let horaC="00:00:00";let horaD="00:00:00";reserva=new ReservaProfessor(nome.value.trim(),equipamento.value.trim(),status,sala.value.trim(),dataA.value,horaA.value,dataB,horaB.value,horaC,horaD);if(reserva.validarDados()){bancodedados.gravar(reserva,"Professor");modalCadastar(reserva.nome,tabelaProfessorA("success",reserva.equipamento,reserva.sala,dataBR(reserva.dataA),horaSeg(reserva.horaA),horaSeg(reserva.horaB)),"Professor");nome.value="";equipamento.value="";sala.value="";dataA.value="";horaA.value="";horaB.value=""}
else{modalCadastrarErro()}}
function cadastrarReservaAluno(){let nome=document.getElementById('aluno');let equipamento=document.getElementById('equipamento');let matricula=document.getElementById('matricula');let serial=document.getElementById('serial');let dataA=document.getElementById('dataA');let horaA=document.getElementById('horaA');let status=null;let horaB=null;let dataB=null;let horaC="00:00:00";if(horaA.value==horaAtualB(0,0)&&dataA.value==dataAtual()){status="Em uso";horaA=horaAtualB(0,0);horaB=horaAtual(0,0,0);dataA=dataAtual();dataB=dataAtual()}
else{status="Aguardando";horaA=document.getElementById('horaA').value;horaB="00:00:00";dataA=document.getElementById('dataA').value;dataB="0000-00-00"}
reserva=new ReservaAluno(nome.value.trim(),equipamento.value.trim(),status,matricula.value.trim(),serial.value.trim(),dataA,horaA,dataB,horaB,horaC);if(reserva.validarDados()){bancodedados.gravar(reserva,"Aluno");modalCadastar(reserva.nome,tabelaAlunoA("success",reserva.matricula,reserva.equipamento,reserva.serial,dataBR(reserva.dataA),horaSeg(reserva.horaA)),"Aluno");nome.value="";matricula.value="";equipamento.value="";serial.value="";horaA.value="";dataA.value=""}else{modalCadastrarErro()}}
function cadastrarFuncionario(){let id=localStorage.getItem("idFuncionario");let dataA=dataAtual();let horaA=horaAtual(0,0,0);let versao=bancodedados.retornaVersao();if(id===null){let nome=prompt("Antes de começarmos informe o seu nome");let funcionario=new Funcionario(nome.trim(),dataA,horaA,versao);if(funcionario.validarFuncionario()){bancodedados.gravarFuncionario(funcionario);modalCadastarFuncionario(funcionario.nome)}
else{modalErro();atualizar()}}}
function ListaReservasProfessores(){app();let reservas=Array();reservas=bancodedados.recuperaReservaProfessor();let listaReservas=document.getElementById("listaProfessores");reservas.forEach(function(p){let linha=listaReservas.insertRow();linha.insertCell(0).innerHTML=p.nome;linha.insertCell(1).innerHTML=p.equipamento;linha.insertCell(2).innerHTML=p.sala;linha.insertCell(3).innerHTML=cor(p.status);linha.insertCell(4).append(botaoVizualizarProfessor(p.id,p.nome,p.equipamento,p.status,p.sala,p.dataA,p.horaA,p.dataB,p.horaB,p.horaC,p.horaD)," ",botaoEditarProfessor(p.id,p.nome,p.equipamento,p.status,p.sala,p.dataA,p.horaA,p.dataB,p.horaB,p.horaC,p.horaD)," ",botaoExcluirProfessor(p.id,p.nome,p.equipamento,p.status,p.sala,p.dataA,p.horaA,p.dataB,p.horaB,p.horaC,p.horaD)," ",botaoVerificarProfessor(p.id,p.nome,p.equipamento,p.status,p.sala,p.dataA,p.horaA,p.dataB,p.horaB,p.horaC,p.horaD))})}
function pesquisarReservaProfessor(){let nome=document.getElementById('professor').value;let equipamento=document.getElementById('equipamento').value;let sala=document.getElementById('sala').value;let horaA=document.getElementById('horaA').value;let horaB=document.getElementById('horaB').value;let dataA=document.getElementById('dataA').value;let status="";let dataB="";if(nome==""&&equipamento==""&&horaA==""&&dataA==""&&sala==""&&horaB==""){modalPesquisarErro()}
else{let reserva=new ReservaProfessor(nome.trim(),equipamento.trim(),status,sala.trim(),dataA,horaA,dataB,horaB);let reservas=bancodedados.pesquisaReserva(reserva,"Professor");let listaReservas=document.getElementById("listaProfessores");listaReservas.innerHTML="";reservas.forEach(function(p){let linha=listaReservas.insertRow();linha.insertCell(0).innerHTML=p.nome;linha.insertCell(1).innerHTML=p.equipamento;linha.insertCell(2).innerHTML=p.sala;linha.insertCell(3).innerHTML=cor(p.status);linha.insertCell(4).append(botaoVizualizarProfessor(p.id,p.nome,p.equipamento,p.status,p.sala,p.dataA,p.horaA,p.dataB,p.horaB,p.horaC,p.horaD)," ",botaoEditarProfessor(p.id,p.nome,p.equipamento,p.status,p.sala,p.dataA,p.horaA,p.dataB,p.horaB,p.horaC,p.horaD)," ",botaoExcluirProfessor(p.id,p.nome,p.equipamento,p.status,p.sala,p.dataA,p.horaA,p.dataB,p.horaB,p.horaC,p.horaD)," ",botaoVerificarProfessor(p.id,p.nome,p.equipamento,p.status,p.sala,p.dataA,p.horaA,p.dataB,p.horaB,p.horaC,p.horaD))})}}
function ListasReservasAlunos(){app();let reservas=Array();reservas=bancodedados.recuperaReservaAluno();let listaReservas=document.getElementById("listaAlunos");reservas.forEach(function(a){let linha=listaReservas.insertRow();linha.insertCell(0).innerHTML=a.nome;linha.insertCell(1).innerHTML=a.matricula;linha.insertCell(2).innerHTML=a.equipamento;linha.insertCell(3).innerHTML=a.serial;linha.insertCell(4).innerHTML=cor(a.status);linha.insertCell(5).append(botaoVizualizarAluno(a.id,a.nome,a.equipamento,a.status,a.matricula,a.serial,a.dataA,a.horaA,a.dataB,a.horaB,a.horaC)," ",botaoEditarAluno(a.id,a.nome,a.equipamento,a.status,a.matricula,a.serial,a.dataA,a.horaA,a.dataB,a.horaB,a.horaC)," ",botaoExcluirAluno(a.id,a.nome,a.equipamento,a.status,a.matricula,a.serial,a.dataA,a.horaA,a.dataB,a.horaB,a.horaC)," ",botaoVerificarAluno(a.id,a.nome,a.equipamento,a.status,a.matricula,a.serial,a.dataA,a.horaA,a.dataB,a.horaB,a.horaC))})}
function pesquisarReservaAluno(){let nome=document.getElementById('aluno').value;let equipamento=document.getElementById('equipamento').value;let matricula=document.getElementById('matricula').value;let serial=document.getElementById('serial').value;let dataA=document.getElementById('dataA').value;let horaA=document.getElementById('horaA').value;let status="";if(nome==""&&equipamento==""&&matricula==""&&serial==""&&dataA==""&&horaA==""){modalPesquisarErro()}
else{reserva=new ReservaAluno(nome.trim(),equipamento.trim(),status,matricula.trim(),serial.trim(),dataA,horaA);console.log(reserva);let reservas=bancodedados.pesquisaReserva(reserva,"Aluno");let listaReservas=document.getElementById("listaAlunos");listaReservas.innerHTML="";reservas.forEach(function(a){let linha=listaReservas.insertRow();linha.insertCell(0).innerHTML=a.nome;linha.insertCell(1).innerHTML=a.matricula;linha.insertCell(2).innerHTML=a.equipamento;linha.insertCell(3).innerHTML=a.serial;linha.insertCell(4).innerHTML=cor(a.status);linha.insertCell(5).append(botaoVizualizarAluno(a.id,a.nome,a.equipamento,a.status,a.matricula,a.serial,a.dataA,a.horaA,a.dataB,a.horaB,a.horaC)," ",botaoEditarAluno(a.id,a.nome,a.equipamento,a.status,a.matricula,a.serial,a.dataA,a.horaA,a.dataB,a.horaB,a.horaC)," ",botaoExcluirAluno(a.id,a.nome,a.equipamento,a.status,a.matricula,a.serial,a.dataA,a.horaA,a.dataB,a.horaB,a.horaC)," ",botaoVerificarAluno(a.id,a.nome,a.equipamento,a.status,a.matricula,a.serial,a.dataA,a.horaA,a.dataB,a.horaB,a.horaC))})}}
let botaoVizualizarAluno=(id,nome,equipamento,status,matricula,serial,dataA,horaA,dataB,horaB,horaC)=>{let ver=document.createElement("button");ver.className='btn btn-outline-info btn-sm';ver.title="Vizualizar";ver.innerHTML='<i class="fa fa-eye"></i>';ver.id=`id-ver-${id}`;ver.onclick=function(){modalVizualizar(nome,tabelaAlunoB("info",equipamento,cor(status),matricula,serial,dataBR(dataA),horaSeg(horaA),dataBR(dataB),horaB,horaC),"Aluno")}
return ver}
let botaoVizualizarProfessor=(id,nome,equipamento,status,sala,dataA,horaA,dataB,horaB,horaC,horaD)=>{let ver=document.createElement("button");ver.className='btn btn-outline-info btn-sm';ver.title="Vizualizar";ver.innerHTML='<i class="far fa-eye"></i>';ver.id=`id-ver-${id}`;ver.onclick=function(){modalVizualizar(nome,tabelaProfessorB("info",equipamento,cor(status),sala,dataBR(dataA),horaSeg(horaA),dataBR(dataB),horaSeg(horaB),horaC,horaD),"Professor")}
return ver}
let botaoEditarAluno=(id,nome,equipamento,status,matricula,serial,dataA,horaA,dataB,horaB,horaC)=>{let editar=document.createElement("button");editar.className='btn btn-outline-success btn-sm';editar.title="Editar";editar.innerHTML='<i class="fas fa-pencil-alt"></i>';editar.id=`id-editar-${id}`;editar.onclick=function(){if(dataA>=dataAtual()){if(horaAtual(0,5,0)<=horaA){if(status=="Aguardando"){let=resposta=prompt("Deseja EDITAR a reserva do(a) Aluno(a) "+nome+"?","Não");if(resposta=="sim"||resposta=="SIM"||resposta=="Sim"||resposta=="s"||resposta=="S"){let _nome=prompt("Nome do(a) Aluno(a):",nome).trim();let _matricula=prompt("Matrícula:",matricula).trim();let _equipamento=prompt("Descrição do equipamento:",equipamento).trim();let _serial=prompt("Nº de série:",serial).trim();let _dataA=prompt("Data:",dataBR(dataA)).trim();let _horaA=prompt("Hora:",horaA).trim();reserva=new ReservaAluno(_nome,_equipamento,status,_matricula,_serial,dataEUA(_dataA),_horaA,dataB,horaB,horaC);if(reserva.validarDados()){let id=this.id.replace('id-editar-','');bancodedados.removerReserva(id);modalEditar(_nome,tabelaAlunoA("success",_equipamento,_matricula,_serial,_dataA,_horaA),"Aluno");bancodedados.gravar(reserva,"Aluno")}
else{modalErro()}}}
else{modalEditarErro(nome,"Aluno")}}
else{modalEditarErro(nome,"Aluno")}}
else{modalEditarErro(nome,"Aluno")}}
return editar}
let botaoEditarProfessor=(id,nome,equipamento,status,sala,dataA,horaA,dataB,horaB,horaC,horaD)=>{let editar=document.createElement("button");editar.className='btn btn-outline-success btn-sm';editar.title="Editar";editar.innerHTML='<i class="fas fa-pencil-alt"></i>';editar.id=`id-editar-${id}`;editar.onclick=function(){if(dataA>=dataAtual()){if(horaAtual(0,0,0)<=horaA){if(status=="Aguardando"){let=resposta=prompt("Deseja EDITAR a reserva do(a) Professor(a) "+nome+"?","Não");if(resposta=="sim"||resposta=="SIM"||resposta=="Sim"||resposta=="s"||resposta=="S"){let _nome=prompt("Nome do(a) Professor(a):",nome).trim();let _equipamento=prompt("Descrição do equipamento:",equipamento).trim();let _sala=prompt("Nome da sala:",sala).trim();let _horaA=prompt("Início da aula:",horaA).trim();let _horaB=prompt("Término da aula:",horaB).trim();let _dataA=prompt("Data da aula:",dataBR(dataA)).trim();let reserva=new ReservaProfessor(_nome,_equipamento,status,_sala,dataEUA(_dataA),_horaA,dataB,_horaB,horaC,horaD);if(reserva.validarDados()){let id=this.id.replace('id-editar-','');bancodedados.removerReserva(id);modalEditar(_nome,tabelaProfessorA("success",_equipamento,_sala,_dataA,_horaA,_horaB),"Professor");bancodedados.gravar(reserva,"Professor")}
else{modalErro()}}}
else{modalEditarErro(nome,"Professor")}}
else{modalEditarErro(nome,"Professor")}}
else{modalEditarErro(nome,"Professor")}}
return editar}
let botaoExcluirAluno=(id,nome,equipamento,status,matricula,serial,dataA,horaA,dataB,horaB,horaC)=>{excluir=document.createElement("button");excluir.className='btn btn-outline-danger btn-sm';excluir.title='Excluir';excluir.innerHTML='<i class="fa fa-trash-alt"></i>';excluir.id=`id-excluir-${id}`;excluir.onclick=function(){let resposta=prompt("Deseja EXCLUIR a reserva do(a) Aluno(a) "+nome+"?","Não");if(resposta=='sim'||resposta=='SIM'||resposta=='Sim'||resposta=='s'||resposta=='S'){let id=this.id.replace('id-excluir-','');bancodedados.removerReserva(id);modalExcluir(nome,tabelaAlunoB("danger",equipamento,cor(status),matricula,serial,dataBR(dataA),horaSeg(horaA),dataBR(dataB),horaB,horaC),"Aluno")}}
return excluir}
let botaoExcluirProfessor=(id,nome,equipamento,status,sala,dataA,horaA,dataB,horaB,horaC,horaD)=>{excluir=document.createElement("button");excluir.className='btn btn-outline-danger btn-sm';excluir.title='Excluir';excluir.innerHTML='<i class="fa fa-trash-alt"></i>';excluir.id=`id-excluir-${id}`;excluir.onclick=function(){let resposta=prompt("Deseja EXCLUIR a reserva do(a) Professor(a) "+nome+"?","Não");if(resposta=='sim'||resposta=='SIM'||resposta=='Sim'||resposta=='s'||resposta=='S'){let id=this.id.replace('id-excluir-','');bancodedados.removerReserva(id);modalExcluir(nome,tabelaProfessorB("danger",equipamento,cor(status),sala,dataBR(dataA),horaSeg(horaA),dataBR(dataB),horaSeg(horaB),horaC,horaD),"Professor")}}
return excluir}
let botaoVerificarAluno=(id,nome,equipamento,status,matricula,serial,dataA,horaA,dataB,horaB,horaC)=>{verificar=document.createElement("button");verificar.className="btn btn-outline-primary btn-sm";verificar.title="Verificar";verificar.innerHTML='<i class="fas fa-user-check"></i>';verificar.id=`id-verifica-${id}`;verificar.onclick=function(){if(status=="Aguardando"){let resposta=prompt("A reserva do(a) Aluno(a) "+nome+" está em uso?","Não");if(resposta=='sim'||resposta=='SIM'||resposta=='Sim'||resposta=='s'||resposta=='S'){let _nome=nome;let _equipamento=equipamento;let _status="Em uso";let _matricula=matricula;let _serial=serial;let _dataA=dataA;let _horaA=horaA;let _dataB=dataAtual();let _horaB=horaAtual(0,0,0);let _horaC=horaC;reserva=new ReservaAluno(_nome,_equipamento,_status,_matricula,_serial,_dataA,_horaA,_dataB,_horaB,_horaC);if(reserva.validarDados()){let id=this.id.replace('id-verifica-','');bancodedados.removerReserva(id);modalVerificar(_nome,tabelaAlunoB("primary",_equipamento,cor(_status),_matricula,_serial,dataBR(_dataA),horaSeg(_horaA),dataBR(_dataB),_horaB,_horaC),"Aluno",_status);bancodedados.gravar(reserva,"Aluno")}
else{modalErro()}}}
else if(status=="Em uso"){let resposta=prompt("A reserva do(a) Aluno(a) "+nome+" está recolhida?","Não");if(resposta=='sim'||resposta=='SIM'||resposta=='Sim'||resposta=='s'||resposta=='S'){let _nome=nome;let _equipamento=equipamento;let _status="Recolhida";let _matricula=matricula;let _serial=serial;let _dataA=dataA;let _horaA=horaA;let _dataB=dataAtual();let _horaB=horaB;let _horaC=horaAtual(0,0,0);reserva=new ReservaAluno(_nome,_equipamento,_status,_matricula,_serial,_dataA,_horaA,_dataB,_horaB,_horaC);if(reserva.validarDados()){let id=this.id.replace('id-verifica-','');bancodedados.removerReserva(id);modalVerificar(_nome,tabelaAlunoB("primary",_equipamento,cor(_status),_matricula,_serial,dataBR(_dataA),horaSeg(_horaA),dataBR(_dataB),_horaB,_horaC),"Aluno",_status);bancodedados.gravar(reserva,"Aluno")}
else{modalErro()}}}
else{modalVerificarErro(nome,"Aluno")}}
return verificar}
let botaoVerificarProfessor=(id,nome,equipamento,status,sala,dataA,horaA,dataB,horaB,horaC,horaD)=>{verificar=document.createElement("button");verificar.className="btn btn-outline-primary btn-sm";verificar.title="Verificar";verificar.innerHTML='<i class="fas fa-user-check"></i>';verificar.id=`id-verifica-${id}`;verificar.onclick=function(){if(status=="Aguardando"){let resposta=prompt("A reserva do(a) Professor(a) "+nome+" já está em uso?","Não");if(resposta=='sim'||resposta=='SIM'||resposta=='Sim'||resposta=='s'||resposta=='S'){let _nome=nome;let _equipamento=equipamento;let _status="Em uso";let _sala=sala;let _dataA=dataA;let _horaA=horaA;let _horaB=horaB;let _dataB=dataAtual();let _horaC=horaAtual(0,0,0);let _horaD=horaD;reserva=new ReservaProfessor(_nome,_equipamento,_status,_sala,_dataA,_horaA,_dataB,_horaB,_horaC,_horaD);if(reserva.validarDados()){modalVerificar(_nome,tabelaProfessorB("primary",_equipamento,cor(_status),_sala,dataBR(_dataA),horaSeg(_horaA),dataBR(_dataB),horaSeg(_horaB),_horaC,_horaD),"Professor",_status);let id=this.id.replace('id-verifica-','');bancodedados.removerReserva(id);bancodedados.gravar(reserva,"Professor")}
else{modalErro()}}}
else if(status=="Em uso"){let resposta=prompt("A reserva do(a) Professor(a) "+nome+" foi recolhida?","Não");if(resposta=='sim'||resposta=='SIM'||resposta=='Sim'||resposta=='s'||resposta=='S'){let _nome=nome;let _equipamento=equipamento;let _status="Recolhida";let _sala=sala;let _dataA=dataA;let _horaA=horaA;let _horaB=horaB;let _dataB=dataB;let _horaC=horaC;let _horaD=horaAtual(0,0,0);reserva=new ReservaProfessor(_nome,_equipamento,_status,_sala,_dataA,_horaA,_dataB,_horaB,_horaC,_horaD);if(reserva.validarDados()){let id=this.id.replace('id-verifica-','');bancodedados.removerReserva(id);modalVerificar(_nome,tabelaProfessorB("primary",_equipamento,cor(_status),_sala,dataBR(_dataA),horaSeg(_horaA),dataBR(_dataB),horaSeg(_horaB),_horaC,_horaD),"Professor",_status);bancodedados.gravar(reserva,"Professor")}
else{modalErro()}}}
else{modalVerificarErro(nome,"Professor")}}
return verificar}
let app=()=>{cadastrarFuncionario();exibirDadosFuncionario();relogio();alertaP();alertaA()}
let cor=status=>{let cor=null;if(status=="Aguardando"){cor='<span class="text-danger"><b>'+status+'</b></span>'}
else if(status=="Em uso"){cor='<span class="text-success"><b>'+status+'</b></span>'}
else{cor='<span class="text-primary"><b>'+status+'</b></span>'}
return cor}
let dataBR=dataEUA=>{let diaBR=dataEUA.substr(8,2);let mesBR="/"+dataEUA.substr(5,2);let anoBR="/"+dataEUA.substr(0,4);let dataBR=diaBR+mesBR+anoBR;return dataBR}
let dataEUA=dataBR=>{let diaEUA=dataBR.substr(6,4);let mesEUA="-"+dataBR.substr(3,2);let anoEUA="-"+dataBR.substr(0,2);let dataEUA=diaEUA+mesEUA+anoEUA;return dataEUA}
let horaSeg=hora=>{let segundos=hora+":00";return segundos}
let relogio=()=>{setInterval(calendario,100)}
function calendario(){let data=dataAtual();let hora=horaAtual(0,0,0);let mensagem=null;mensagem=hora>="06:00:00"&&hora<="12:00:00"?mensagem="<i class='fas fa-sun'></i> Bom dia! ":mensagem;mensagem=hora>="12:00:00"&&hora<="18:00:00"?mensagem="<i class='fas fa-sun'></i> Boa tarde! ":mensagem;mensagem=hora>="18:00:00"||hora<="06:00:00"?mensagem="<i class='fas fa-moon'></i> Boa noite! ":mensagem;document.getElementById("tempo").innerHTML=mensagem+"hoje é "+dataBR(data)+" e são "+hora+" |"}
let dataAtual=()=>{let time=new Date();let ano=time.getFullYear();let mes=time.getMonth()+1;let dia=time.getDate();mes=mes<10?mes="0"+mes:mes;dia=dia<10?dia="0"+dia:dia;let data=ano+"-"+mes+"-"+dia;return data}
let horaAtual=(h,m,s)=>{let time=new Date();let horas=time.getHours()+h;let minutos=time.getMinutes()+m;let segundos=time.getSeconds()+s;horas=horas<10?horas="0"+horas:horas;minutos=minutos<10?minutos="0"+minutos:minutos;segundos=segundos<10?segundos="0"+segundos:segundos;let hora=horas+":"+minutos+":"+segundos;return hora}
let horaAtualB=(h,m)=>{let time=new Date();let horas=time.getHours()+h;let minutos=time.getMinutes()+m;horas=horas<10?horas="0"+horas:horas;minutos=minutos<10?minutos="0"+minutos:minutos;let hora=horas+":"+minutos;return hora}
let tabelaProfessorA=(bg,equipamento,sala,dataA,horaA,horaB)=>{let tabela='<br><br><table class="table table-bordered text-center"><thead><tr class="text-center bg-'+bg+'"><th scope="col" class="text-white"><i class="fas fa-desktop" title="Equipamento"></i></th><th scope="col" class="text-white"><i class="fas fa-compass" title="Local"></i></th><th scope="col" class="text-white"><i class="fas fa-user-clock" title="Horário da reserva"></i></th></tr></thead><tbody><tr><td>'+equipamento+'</td><td>'+sala+'</td><td>'+dataA+'<br>'+horaA+' / '+horaB+'</td></tr></tbody></table>';return tabela}
let tabelaProfessorB=(bg,equipamento,status,sala,dataA,horaA,dataB,horaB,horaC,horaD)=>{let tabela='<br><br><table class="table table-bordered text-center"><thead><tr class="text-center bg-'+bg+'"><th scope="col" class="text-white"><i class="fas fa-desktop" title="Equipamento"></i></th><th scope="col" class="text-white"><i class="fas fa-compass" title="Local"></i></th><th scope="col" class="text-white"><i class="fas fa-user-clock" title="Horário da reserva"></i></th><th scope="col" class="text-white"><i class="fas fa-user-clock" title="Horário final"></i></th><th class="text-white" title="Status"><i class="fas fa-clipboard-check" title="Status"></i></th></tr></thead><tbody><tr><td>'+equipamento+'</td><td>'+sala+'</td><td>'+dataA+'<br>'+horaA+' / '+horaB+'</td><td>'+dataB+'<br>'+horaC+' / '+horaD+'</td><td>'+status+'</td></tr></tbody></table>';return tabela}
let tabelaAlunoA=(bg,equipamento,matricula,serial,dataA,horaA)=>{let tabela='<br><br><table class="table table-bordered text-center"><thead><tr class="text-center bg-'+bg+'"><th scope="col" class="text-white"><i class="fas fa-address-card" title="Matrícula"></i></th><th scope="col" class="text-white"><i class="fas fa-laptop" title="Equipamento"></i></th><th scope="col" class="text-white"><i class="fas fa-barcode" title="Nº de série"></i></th><th scope="col" class="text-white"><i class="fas fa-user-clock" title="Data e hora"></i></i></th></tr></thead><tbody><tr><th class="font-weight-normal">'+matricula+'</th><td>'+equipamento+'</td><td>'+serial+'</td><td>'+dataA+'<br>'+horaA+'</td></tr></tbody></table>';return tabela}
let tabelaAlunoB=(bg,equipamento,status,matricula,serial,dataA,horaA,dataB,horaB,horaC)=>{let tabela='<br><br><table class="table table-bordered text-center"><thead><tr class="text-center bg-'+bg+'"><th scope="col" class="text-white"><i class="fas fa-address-card" title="Matrícula"></i></th><th scope="col" class="text-white"><i class="fas fa-laptop" title="Equipamento"></i></th><th scope="col" class="text-white"><i class="fas fa-barcode" title="Nº de série"></i></th><th scope="col" class="text-white"><i class="fas fa-user-clock" title="Horário da reserva"></i></th><th scope="col" class="text-white"><i class="fas fa-user-clock" title="Horário final"></i></th><th class="text-white" title="Status"><i class="fas fa-clipboard-check" title="Status"></i></th></tr></thead><tbody><tr><td>'+matricula+'</td><td>'+equipamento+'</td><td>'+serial+'</td><td>'+dataA+'<br>'+horaA+'</td><td>'+dataB+'<br>'+horaB+' / '+horaC+'</td><td>'+status+'</td></tr></tbody></table>';return tabela}
let tabelaApp=(nome,versao,dataA,horaA)=>{let tabela='<br><br><table class="table table-bordered text-center"><thead><tr class="text-center bg-info"><th scope="col" class="text-white"><i class="fas fa-user-circle" title="Funcionário"></i></th><th scope="col" class="text-white"><i class="fas fa-user-tag" title="Versão"></i></th><th scope="col" class="text-white"><i class="fas fa-user-clock" title="Cadastro"></th><th scope="col" class="text-white"><i class="fab fa-github" title="GitHub"></i></th></tr></thead><tbody><tr><td>'+nome+'</td><td>'+versao+'</td><td>'+dataA+'<br>'+horaA+'</td><td><b><a href="https://github.com/JefersonLucas/reserve" target="_blank" title="Projeto">GitHub</a></b></td></tr></tbody></table>';return tabela}
let alertaP=()=>{setInterval(alertarReservaP,30000)}
function alertarReservaP(){reservas=bancodedados.recuperaReservaProfessor();reservas.forEach(function(p){if(p.dataA==dataAtual()){if(p.status=="Aguardando"){if(horaAtualB(0,0)>=p.horaA){modalAlertarReserva(p.nome,tabelaProfessorB("warning",p.equipamento,cor(p.status),p.sala,dataBR(p.dataA),horaSeg(p.horaA),dataBR(dataAtual()),p.horaB,horaAtual(0,0,0),p.horaD),"Professor","iniciar")}}
if(p.status=="Em uso"){if(horaAtualB(0,0)>=p.horaB){modalAlertarReserva(p.nome,tabelaProfessorB("warning",p.equipamento,cor(p.status),p.sala,dataBR(p.dataA),horaSeg(p.horaA),dataBR(p.dataB),p.horaB,p.horaC,horaAtual(0,0,0)),"Professor","acabar")}}}})}
let alertaA=()=>{setInterval(alertarReservaA,30000)}
function alertarReservaA(){reservas=bancodedados.recuperaReservaAluno();reservas.forEach(function(a){if(a.dataA==dataAtual()){if(a.status=="Aguardando"){if(horaAtualB(0,0)>=a.horaA){modalAlertarReserva(a.nome,tabelaAlunoB("warning",a.equipamento,cor(a.status),a.matricula,a.serial,dataBR(a.dataA),horaSeg(a.horaA),dataBR(a.dataB),a.horaB,a.horaC),"Aluno","iniciar")}}}})}
let infoApp=()=>{let funcionario=Array();funcionario=bancodedados.recuperarDadosFuncionario();funcionario.forEach(function(f){let versao=bancodedados.retornaVersao();modalInfoApp(tabelaApp(f.nome,versao,dataBR(f.dataA),f.horaA))})}
let exibirDadosFuncionario=()=>{let funcionario=Array();funcionario=bancodedados.recuperarDadosFuncionario();funcionario.forEach(function(f){document.getElementById("funcionario").innerHTML=f.nome})}
let imprimir=()=>{let imprime=document.getElementById('conteudo-imprecao').innerHTML;telaImpressao=window.open('about:blank');telaImpressao.document.write(imprime);telaImpressao.window.print();telaImpressao.window.close()}
let atualizar=()=>{window.location.reload()}
$(function(){$('[data-toggle="popover"]').popover()})
$(function(){$('[data-toggle="tooltip"]').tooltip()})
let modalCadastar=(nome,tabela,responsavel)=>{$('#modal1').modal('show');document.getElementById('modal-titulo-1').innerHTML='<i class="fas fa-check-circle"></i> Sucesso!';document.getElementById('modal-documento-1').className='modal-dialog border border-success rounded alert-success';document.getElementById('modal-cabecalho-1').className='modal-header text-white bg-success';document.getElementById('modal-conteudo-1').innerHTML='A reserva do '+responsavel+'(a) <span class="text-success"><b>'+nome+'</b></span> foi cadastrada com <span class="text-success"><b>sucesso</b></span>!'+tabela;document.getElementById('modal-botao-1').innerHTML='Voltar';document.getElementById('modal-botao-1').className='btn btn-outline-success'}
let modalCadastrarErro=()=>{$('#modal2').modal('show');document.getElementById('modal-titulo-2').innerHTML='<i class="fas fa-times-circle"></i> Erro!';document.getElementById('modal-documento-2').className='modal-dialog border border-danger rounded alert-danger';document.getElementById('modal-cabecalho-2').className='modal-header text-white bg-danger';document.getElementById('modal-conteudo-2').innerHTML='Erro ao efetuar seu <span class="text-danger"><b>cadastro</b></span>. Por favor verifique se todos os campo foram inseridos corretamente.';document.getElementById('modal-botao-2').innerHTML='Corrigir';document.getElementById('modal-botao-2').className='btn btn-outline-danger'}
let modalVizualizar=(nome,tabela,responsavel)=>{$('#modal2').modal('show');document.getElementById('modal-titulo-2').innerHTML='<i class="fas fa-eye"></i> Informações';document.getElementById('modal-documento-2').className='modal-dialog modal-lg border border-info rounded alert-info';document.getElementById('modal-cabecalho-2').className='modal-header text-white bg-info';document.getElementById('modal-conteudo-2').innerHTML='Detalhes da reserva do(a) '+responsavel+'(a): <span class="text-info"><b>'+nome+'</b></span>'+tabela;document.getElementById('modal-botao-2').innerHTML='Voltar';document.getElementById('modal-botao-2').className='btn btn-outline-info'}
let modalEditar=(nome,tabela,responsavel)=>{$('#modal1').modal('show');document.getElementById('modal-titulo-1').innerHTML='<i class="fas fa-pencil-alt"></i> Editar';document.getElementById('modal-documento-1').className='modal-dialog border border-success rounded alert-success';document.getElementById('modal-cabecalho-1').className='modal-header text-white bg-success';document.getElementById('modal-conteudo-1').innerHTML='A reserva do(a) '+responsavel+'(a) <span class="text-success"><b>'+nome+'</b></span> foi alterada com <span class="text-success"><b>sucesso</b></span>!'+tabela;document.getElementById('modal-botao-1').innerHTML='Voltar';document.getElementById('modal-botao-1').className='btn btn-outline-success'}
let modalEditarErro=(nome,responsavel)=>{$('#modal2').modal('show');document.getElementById('modal-titulo-2').innerHTML='<i class="fas fa-times-circle"></i> Erro!';document.getElementById('modal-documento-2').className='modal-dialog border border-danger rounded alert-danger';document.getElementById('modal-cabecalho-2').className='modal-header text-white bg-danger';document.getElementById('modal-conteudo-2').innerHTML='Você não pode alterar a reserva do(a) '+responsavel+'(a) <span class="text-danger"><b>'+nome+'</b></span>.';document.getElementById('modal-botao-2').innerHTML='Voltar';document.getElementById('modal-botao-2').className='btn btn-outline-danger'}
let modalExcluir=(nome,tabela,responsavel)=>{$('#modal1').modal('show');document.getElementById('modal-titulo-1').innerHTML='<i class="fa fa-trash-alt"></i> Excluir';document.getElementById('modal-documento-1').className='modal-dialog modal-lg border border-danger rounded alert-danger';document.getElementById('modal-cabecalho-1').className='modal-header text-white bg-danger';document.getElementById('modal-conteudo-1').innerHTML='A reserva do(a) '+responsavel+'(a) <span class="text-danger"><b>'+nome+'</b></span> irá ser <span class="text-danger"><b>excluída</b></span>!'+tabela;document.getElementById('modal-botao-1').innerHTML='Voltar';document.getElementById('modal-botao-1').className='btn btn-outline-danger'}
let modalVerificar=(nome,tabela,responsavel,status)=>{$('#modal1').modal('show');document.getElementById('modal-titulo-1').innerHTML='<i class="fas fa-user-check"></i> Verificada';document.getElementById('modal-documento-1').className='modal-dialog modal-lg border border-primary rounded alert-primary';document.getElementById('modal-cabecalho-1').className='modal-header text-white bg-primary';document.getElementById('modal-conteudo-1').innerHTML='A reserva do(a) '+responsavel+'(a) <span class="text-primary"><b>'+nome+'</b></span> está <span class="text-primary"><b>'+status+'</b></span>!'+tabela;document.getElementById('modal-botao-1').innerHTML='Voltar';document.getElementById('modal-botao-1').className='btn btn-outline-primary'}
let modalVerificarErro=(nome,responsavel)=>{$('#modal2').modal('show');document.getElementById('modal-titulo-2').innerHTML='<i class="fas fa-user-check"></i> Verificada';document.getElementById('modal-documento-2').className='modal-dialog border border-danger rounded alert-danger';document.getElementById('modal-cabecalho-2').className='modal-header text-white bg-danger';document.getElementById('modal-conteudo-2').innerHTML='A reserva do(a) '+responsavel+'(a) <span class="text-danger"><b>'+nome+'</b></span> já está <span class="text-danger"><b>recolhida</b></span>!';document.getElementById('modal-botao-2').innerHTML='Voltar';document.getElementById('modal-botao-2').className='btn btn-outline-danger'}
let modalAlertarReserva=(nome,tabela,responsavel,alerta)=>{$('#modal2').modal('show');document.getElementById('modal-titulo-2').innerHTML='<i class="fas fa-bell" title="Alerta"></i> Atenção!';document.getElementById('modal-documento-2').className='modal-dialog modal-lg border border-warning rounded alert-warning';document.getElementById('modal-cabecalho-2').className='modal-header text-white bg-warning';document.getElementById('modal-conteudo-2').innerHTML='A reserva do(a) '+responsavel+'(a) <span class="text-warning"><b>'+nome+'</b></span> já está pra <span class="text-warning"><b>'+alerta+'</b></span>!'+tabela;document.getElementById('modal-botao-2').innerHTML='Voltar';document.getElementById('modal-botao-2').className='btn btn-outline-warning'}
let modalInfoApp=tabela=>{$('#modal2').modal('show');document.getElementById('modal-titulo-2').innerHTML='<i class="fa fa-info-circle"></i> Informações';document.getElementById('modal-documento-2').className='modal-dialog border border-info rounded alert-info';document.getElementById('modal-cabecalho-2').className='modal-header text-white bg-info';document.getElementById('modal-conteudo-2').innerHTML='Informações dos detalhes do App Reserve:'+tabela;document.getElementById('modal-botao-2').innerHTML='Voltar';document.getElementById('modal-botao-2').className='btn btn-outline-info'}
let modalErro=()=>{$('#modal2').modal('show');document.getElementById('modal-titulo-2').innerHTML='<i class="fas fa-times-circle"></i> Erro!';document.getElementById('modal-documento-2').className='modal-dialog border border-danger rounded alert-danger';document.getElementById('modal-cabecalho-2').className='modal-header text-white bg-danger';document.getElementById('modal-conteudo-2').innerHTML='Desculpe houve algum <span class="text-danger"><b>erro</b></span>!';document.getElementById('modal-botao-2').innerHTML='Voltar';document.getElementById('modal-botao-2').className='btn btn-outline-danger'}
let modalCadastarFuncionario=nome=>{$('#modal2').modal('show');document.getElementById('modal-titulo-2').innerHTML='<i class="fas fa-user-circle"></i> '+nome+' seja bem vindo(a)!';document.getElementById('modal-documento-2').className='modal-dialog border border-info rounded alert-info';document.getElementById('modal-cabecalho-2').className='modal-header text-white bg-info';document.getElementById('modal-conteudo-2').innerHTML='O App Reserve está atualizado com novas funcionalidades para a reserva dos equipamentos. Você pode obter mais informações vendo nesse <a href="https://github.com/JefersonLucas/reserve#changelog--versões" target="_blank">link</a> aqui.';document.getElementById('modal-botao-2').innerHTML='Voltar';document.getElementById('modal-botao-2').className='btn btn-outline-info'}
let modalPesquisarErro=()=>{$('#modal2').modal('show');document.getElementById('modal-titulo-2').innerHTML='<i class="fas fa-times-circle"></i> Erro!';document.getElementById('modal-documento-2').className='modal-dialog border border-danger rounded alert-danger';document.getElementById('modal-cabecalho-2').className='modal-header text-white bg-danger';document.getElementById('modal-conteudo-2').innerHTML='Erro ao efetuar sua <span class="text-danger"><b>pesquisa</b></span>. Por favor verifique se todos os campo foram inseridos corretamente.';document.getElementById('modal-botao-2').innerHTML='Corrigir';document.getElementById('modal-botao-2').className='btn btn-outline-danger'}